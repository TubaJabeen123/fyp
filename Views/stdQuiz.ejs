<!DOCTYPE html>
<html lang="en">
<head>
  <title>Std Quiz </title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="description" content="Unicat project" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- CSS files -->
  <link rel="stylesheet" type="text/css" href="/bootstrap4/bootstrap.min.css" />
  <link href="/plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" type="text/css" href="/plugins/OwlCarousel2-2.2.1/owl.carousel.css" />
  <link rel="stylesheet" type="text/css" href="/plugins/OwlCarousel2-2.2.1/owl.theme.default.css" />
  <link rel="stylesheet" type="text/css" href="/plugins/OwlCarousel2-2.2.1/animate.css" />
  <link rel="stylesheet" type="text/css" href="/css-file/main_styles.css" />
  <link rel="stylesheet" type="text/css" href="/css-file/responsive.css" />

  <!-- External resources -->
   <!-- main css file -->
<link rel="stylesheet" href="/css-file/QuizStyle.css">
<link rel="stylesheet" href="/css-file/tchrConsole.css">
<!-- External resources -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
 .home{
  padding-top: 50px;
  padding-bottom: 40px;
  margin-top: 80px;
  margin-bottom: 40;
 }
 .footer_links_container li{ 
    background-color: #232835;
  }
  .footer_social li{
    background-color: #1e2434;
  }
  .footer_contact_info li{
    background-color: #1e2434;

  }
  /* Initially show the modal */
.modal {
    display: block; /* Show modal first */
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
}

.modal-content {
    background-color: white;
    margin: 10% auto;
    padding: 20px;
    width: 50%;
    border-radius: 8px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
}

/* Close button */
.close {
    float: right;
    font-size: 28px;
    cursor: pointer;
}
#timer {
  position: fixed;
  top: 10px;
  right: 20px;
  background: #fff3cd;
  padding: 10px 20px;
  border: 2px solid #ffc107;
  border-radius: 10px;
  z-index: 1000;
}

/* Initially hide quiz form */
.quizContainer {
    display: none;
}

/* Hide modal after form submission */
.modal.hidden {
    display: none;
}

/* Show quiz form when data is available */
.quizContainer.visible {
    display: block;
}
/* Scrollable Quiz Container */
.quizContainer {
  /* Fixed height - adjust based on your needs */
  height: 800px;
width: 100%;
  /* Enable vertical scrolling */
  overflow-y: auto;

  /* Disable horizontal scrolling */
  overflow-x: hidden;

  /* Smooth scrolling behavior */
  scroll-behavior: smooth;

  /* Add some padding and styling */
  padding: 20px;
  border-radius: 8px;
  border: 1px solid #e0e0e0;
  background-color: #f9f9f9;

  /* Ensure the container has proper spacing */
  margin-bottom: 20px;

  /* Scrollbar styling for WebKit browsers (Chrome, Safari) */
  &::-webkit-scrollbar {
    width: 8px;
  }

  &::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
  }

  &::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 10px;
  }

  &::-webkit-scrollbar-thumb:hover {
    background: #a8a8a8;
  }

  /* Firefox scrollbar styling */
  scrollbar-width: thin;
  scrollbar-color: #c1c1c1 #f1f1f1;
}

/* Fixed timer position at the top of the quiz */
/* #timer {
  position: sticky;
  top: 0;
  background-color: #f9f9f9;
  padding: 10px 0;
  z-index: 10;
  border-bottom: 1px solid #e0e0e0;
  margin-bottom: 15px;
} */

/* Style for quiz questions */
.quizForm > div {
  margin-bottom: 25px;
  padding-bottom: 20px;
  border-bottom: 1px solid #e0e0e0;
}

/* Style for question text */
.quizForm p {
  font-weight: bold;
  margin-bottom: 10px;
  font-size: 16px;
}

/* Style for answer options */
.quizForm label {
  display: block;
  padding: 8px 10px;
  margin-bottom: 5px;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.quizForm label:hover {
  background-color: #f0f0f0;
}

/* Style for submit button */
.quizForm button[type="submit"] {
  background-color: #4caf50;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  margin-top: 10px;
  transition: background-color 0.3s;
}

/* .quizForm button[type="submit"]:hover {
  background-color: #45a049;
} */

/* For IE and Edge */
.quizContainer {
  -ms-overflow-style: -ms-autohiding-scrollbar;
}

</style>

</head>

<body>
  <div class="super_container">
    <!-- Header Section -->
    <header class="header">
      <!-- Top Bar -->
      
      <!-- Header Content -->
      <div class="header_container">
        <div class="container">
          <div class="row">
            <div class="col">
              <div class="header_content d-flex flex-row align-items-center justify-content-start">
                <div class="header_content d-flex flex-row align-items-center justify-content-start">
                  <a href="javascript:history.back()"  style="display: flex; align-items: center; text-decoration: none;  font-size: 30px;">
                    <i class="fa fa-arrow-left" style="margin: 9px; padding: 10px;"></i> 
                  <img src="/images/R.jpeg" class="uniLogo" alt="UniLogo">
                <div class="logo_container">
                  <a href="#">
                    <div class="logo_text">Physics<span>Verse</span></div>
                  </a>
                </div></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Home Section -->
    <div class="home">
      <!-- Button to open modal -->
      <button id="openModalBtn">Select Experiment</button>
  
      <!-- Modal -->
      <div id="experimentModal" class="modal">
          <div class="modal-content">
              <span class="close" id="closeModalBtn">&times;</span>
              <h1>Quiz</h1>
              <form id="expForm" method="POST" action="/std/get-quiz">
                <label for="exp_no">Experiment Number:</label>
                <select name="exp_no" id="exp_no" required>
                  <option value="">Select</option>
                  <% experiments.forEach(function(experiment) { %>
                    <option value="<%= experiment.exp_no %>"><%= experiment.exp_title %></option>
                  <% }) %>
                </select><br>
                <button type="submit"><i class="fas fa-paper-plane"></i>
                  Load Quiz</button>
              </form>
              
          </div>
      </div>
  
      <!-- Quiz Form -->
      <div class="quizContainer" id="quizContainer">
        <div id="timer" style="font-size: 20px; font-weight: bold; color: rgb(3, 37, 20); margin-bottom: 10px;">
          Time Remaining: <span id="time">5:00</span>
        </div>
        
        <% if (quizData && quizData.length > 0) { %>
          <h2 style="text-align: center;">Quiz for Experiment <%= quizData[0].exp_no %></h2>
          <form id="quizForm" method="POST" action='/std/submit-quiz' class="quizForm">

              <% quizData.forEach(function(question, index) { %>
                  <div>
                      <p><%= index + 1 %>. <%= question.Question %></p>
                      <label><input type="checkbox" name="answers[<%= index %>]" value="option1"> <%= question.option1 %></label><br>
                      <label><input type="checkbox" name="answers[<%= index %>]" value="option2"> <%= question.option2 %></label><br>
                      <label><input type="checkbox" name="answers[<%= index %>]" value="option3"> <%= question.option3 %></label><br>
                      <label><input type="checkbox" name="answers[<%= index %>]" value="option4"> <%= question.option4 %></label><br>
                      <input type="hidden" name="correctAnswers[<%= index %>]" value="<%= question.Answer %>">

                  </div>
              <% }) %>
              <input type="hidden" name="exp_no" value="<%= quizData[0].exp_no %>"> <br>
              <button type="submit"><i class="fas fa-arrow-circle-up"></i>
                Submit Quiz</button>
          </form>
      <% } else { %>
          <p style="color: red; font-weight: bold;">No quizzes assigned yet.</p>
      <% } %>
                
            
      </div>
  </div>
  
    <!-- Footer Section -->
    <footer class="footer">
      <div class="footer_background" style="background-image: url(/images/footer_background.png)"></div>
      <div class="container">
        <div class="row footer_row">
          <!-- About Section -->
          <div class="col-lg-4 col-md-6 footer_col">
            <div class="footer_section footer_about">
              <div class="footer_logo_container">
                <a href="#">
                  <div class="footer_logo_text">Physics<span>Verse</span></div>
                </a>
              </div>
              <div class="footer_about_text">
                <p>A virtual physics Lab. Explore the wonders of physics with PhysicsVerse.</p>
              </div>
              <div class="footer_social">
                <ul>
                  <li><a href="#"><i class="fab fa-facebook" aria-hidden="true"></i></a></li>
                  <li><a href="#"><i class="fab fa-google-plus" aria-hidden="true"></i></a></li>
                  <li><a href="#"><i class="fab fa-instagram" aria-hidden="true"></i></a></li>
                  <li><a href="#"><i class="fab fa-twitter" aria-hidden="true"></i></a></li>
                </ul>
              </div>
            </div>
          </div>
  
          <!-- Useful Links Section -->
          <div class="col-lg-3 col-md-6 footer_col">
            <div class="footer_section footer_links">
              <div class="footer_title">Useful Links</div>
              <div class="footer_links_container">
                <ul>
                  <li><a href="#" id="footer_home">Home</a></li>
                  <li><a href="#" id="footer_about">About Us</a></li>
                  <!-- <li><a href="#" id="footer_courses">Experiments</a></li> -->
                  <li><a href="#" id="footer_contact">Contact</a></li>
                </ul>
              </div>
            </div>
          </div>
  
          <!-- Contact Section -->
          <div class="col-lg-5 col-md-12 footer_col">
            <div class="footer_section footer_contact">
              <div class="footer_title">Contact Us</div>
              <div class="footer_contact_info">
                <ul>
                  <li><i class="fa fa-user" aria-hidden="true"></i>Tuba Jabeen | Isha Eman</li>
                  <li><i class="fa fa-phone" aria-hidden="true"></i> +92-3345605064 | +92-3019575969</li>
                  <li><i class="fa fa-envelope" aria-hidden="true"></i> fa21-bcs-033@cuiatk.edu.pk |
                    fa21-bcs-046@cuiatk.edu.pk</li>
                </ul>
              </div>
            </div>
          </div>
        </div> <!-- Close footer_row -->
  
        <!-- Copyright Section -->
        <div class="row">
          <div class="col">
            <div class="footer_copyright">
              <p>&copy; 2025 PhysicsVerse. All rights reserved.</p>
            </div>
          </div>
        </div>
      </div>
    </footer>
  
      </div>
  <!-- jQuery (make sure this is above Bootstrap JS) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <!-- Bootstrap JS Bundle -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  
  <!-- Local JavaScript files -->
  <script src="/js/jquery-3.2.1.min.js"></script>
  <script src="/bootstrap4/popper.js"></script>
  <script src="/bootstrap4/bootstrap.min.js"></script>
  <script src="/plugins/greensock/TweenMax.min.js"></script>
  <script src="/plugins/greensock/TimelineMax.min.js"></script>
  <script src="/plugins/scrollmagic/ScrollMagic.min.js"></script>
  <script src="/plugins/greensock/animation.gsap.min.js"></script>
  <script src="/plugins/greensock/ScrollToPlugin.min.js"></script>
  <script src="/plugins/OwlCarousel2-2.2.1/owl.carousel.js"></script>
  <script src="/plugins/easing/easing.js"></script>
  <script src="/plugins/parallax-js-master/parallax.min.js"></script>
  
  <!-- Custom JavaScript -->
  <script src="/js/custom.js"></script>
  <!-- Local JavaScript files -->
<script>
 document.addEventListener("DOMContentLoaded", function () {
    const modal = document.getElementById("experimentModal");
    const quizContainer = document.getElementById("quizContainer");
    const closeModalBtn = document.getElementById("closeModalBtn");

  "<% if (quizData && quizData.length > 0) { %>"
  modal.classList.add("hidden");  // Hide modal
  modal.style.display = "none";   // Hide modal
  quizContainer.style.display = "block";  // Show quiz
  openModalBtn.style.display = "none";  // Hide the 'Select Experiment' button
  quizContainer.classList.add("visible"); // Show quiz
"<% } %>"

    // Close modal manually
    closeModalBtn.addEventListener("click", function () {
        modal.classList.add("hidden");
    });
});

  let totalSeconds = 5 * 60; // 5minutes
  const timerDisplay = document.getElementById('time');
  const quizForm = document.getElementById('quizForm');

  function startTimer() {
    const interval = setInterval(() => {
      const minutes = Math.floor(totalSeconds / 60);
      const seconds = totalSeconds % 60;
      timerDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
      totalSeconds--;

      if (totalSeconds < 0) {
        clearInterval(interval);
        alert("Time is up! Quiz will be submitted automatically.");

        // Disable all checkboxes
        const checkboxes = quizForm.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(cb => cb.checked = false);

        // Create a hidden field to indicate timeout
        const timeoutInput = document.createElement('input');
        timeoutInput.type = 'hidden';
        timeoutInput.name = 'timeout';
        timeoutInput.value = 'true';
        quizForm.appendChild(timeoutInput);

        // Submit the form
        quizForm.submit();
      }
    }, 1000);
  }

  // Start timer when quiz loads
  if (quizForm) {
    startTimer();
  }
  document.addEventListener("DOMContentLoaded", () => {
  // Add validation alert div to the container
  const quizContainer = document.getElementById("quizContainer")
  const timer = document.getElementById("timer")

  // Create validation alert element
  const validationAlert = document.createElement("div")
  validationAlert.id = "validationAlert"
  validationAlert.textContent = "Please answer all questions before submitting."
  quizContainer.insertBefore(validationAlert, timer.nextSibling)

  const quizForm = document.getElementById("quizForm")
  const submitButton = quizForm.querySelector('button[type="submit"]')

  // Initially disable the submit button
  submitButton.disabled = true

  // Function to check if all questions are answered
  function checkAllQuestionsAnswered() {
    // Get all question divs (direct children of the form that contain checkboxes)
    const questionDivs = Array.from(quizForm.querySelectorAll("div"))

    // Check if each question has at least one checkbox checked
    let allAnswered = true
    const unansweredQuestions = []

    questionDivs.forEach((div, index) => {
      const checkboxes = div.querySelectorAll('input[type="checkbox"]')
      if (checkboxes.length === 0) return // Skip if not a question div

      let isAnswered = false
      checkboxes.forEach((checkbox) => {
        if (checkbox.checked) {
          isAnswered = true
        }
      })

      if (!isAnswered) {
        allAnswered = false
        unansweredQuestions.push(div)
        div.classList.add("question-unanswered")
      } else {
        div.classList.remove("question-unanswered")
      }
    })

    // Enable or disable submit button based on all questions being answered
    submitButton.disabled = !allAnswered

    // Show or hide validation alert
    if (!allAnswered) {
      validationAlert.classList.add("show")
    } else {
      validationAlert.classList.remove("show")
    }

    return { allAnswered, unansweredQuestions }
  }

  // Add event listeners to all checkboxes
  const allCheckboxes = quizForm.querySelectorAll('input[type="checkbox"]')
  allCheckboxes.forEach((checkbox) => {
    checkbox.addEventListener("change", () => {
      checkAllQuestionsAnswered()
    })
  })

  // Add submit event listener
  quizForm.addEventListener("submit", (event) => {
    const { allAnswered, unansweredQuestions } = checkAllQuestionsAnswered()

    if (!allAnswered) {
      event.preventDefault()

      // Scroll to the first unanswered question
      if (unansweredQuestions.length > 0) {
        unansweredQuestions[0].scrollIntoView({ behavior: "smooth", block: "center" })
      }
    }
  })
})

</script>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

</body>
</html>
